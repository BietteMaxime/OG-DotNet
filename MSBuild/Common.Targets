<?xml version="1.0" encoding="utf-8" ?>
<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">

  <Import Project="$(MSBuildExtensionsPath)\MSBuildCommunityTasks\MSBuild.Community.Tasks.Targets"/>
  
  <Target Name="BeforeBuild" Condition=" '$(BuildingInsideVisualStudio)'!='true' ">
    <PropertyGroup>
      <VersionString>1.0.0.$(Revision)</VersionString>
      <VersionFileName>Properties\VersionInfo.cs</VersionFileName>
    </PropertyGroup>

    <Error Condition=" '$(Revision)' == ''" Text="Revision number not specified, this will break the build" />
    
    <AssemblyInfo CodeLanguage="CS"
                  OutputFile="$(VersionFileName)"
                  AssemblyVersion="$(VersionString)"
                  AssemblyFileVersion="$(VersionString)"
                  AssemblyInformationalVersion="$(VersionString) $(BuildName)" 
                  />

    <ItemGroup>
      <Compile Include="$(VersionFileName)">
        <SubType>Code</SubType>
      </Compile>
    </ItemGroup>
  </Target>

  <Target Name="BeforeBuild" >
    <CreateProperty  Value="$(MSBuildProjectDirectory)\..\lib\;$(AssemblySearchPaths)">  
		<Output TaskParameter="Value" PropertyName="AssemblySearchPaths" />  
	</CreateProperty>  
  </Target>
  
  <Target Name="AfterBuild" Condition=" '$(BuildingInsideVisualStudio)'!='true' ">
    <Delete  Files="$(VersionFileName)" />


  </Target>
</Project>